\newpage
\section{Come tradurre la logica predicativa con uguaglianza in teoria dei tipi}
\subsection{Esercizio 1}
\begin{thm}[Assioma di Scelta] Si mostri che la traduzione CHM della logica nella teoria dei tipi rende valido l'assioma di scelta
	\[ (\forall x\in A)\ (\exists y\in B)\  R(x, y)\ \to\ (\exists f\in A\to B)\ (\forall x\in A)\ R(x, f(x))\ \mathrm{true}\ [\ ] \]
	
\end{thm}

\proof
Occorre trovare un proof-term $\textbf{pf}$ del tipo
\[\textbf{pf} \equiv \lambda w.p(w) \in \Pi_{x\in A}\Sigma_{y\in B}R(x,y)\to\ \Sigma_{f\in {\Pi_A B}}\Pi_{x\in A}R(x, f(x))\ [\ ] \]
per cui basta avere un proof-term del tipo (introduzione di $\to$)
\[ p(w) \in \Sigma_{f\in {\Pi_A B}}\Pi_{x\in A}R(x, f(x))\ [w\in \Pi_{x\in A}\Sigma_{y\in B}R(x,y) ] \]
Avendo $w\in \Pi_{x\in A}\Sigma_{y\in B}R(x,y)$, usando l'eliminatore del $\Pi$ si ottiene 
\[ \mathrm{Ap}(w, x)\in \Sigma_{y\in B}R(x,y) \]
e quindi, usando l'eliminatore del $\Sigma$,
\[ \pi_1(\mathrm{Ap}(w,x))\in B \qquad \pi_2(\mathrm{Ap}(w,x))\in R(x, \pi_1(\mathrm{Ap}(w, x)))\]
pertanto possiamo definire
\[ p(w) \equiv \langle \lambda x. \pi_1(\mathrm{Ap}(w, x)), \lambda x.\pi_2(\mathrm{Ap}(w, x))\rangle \]
\endproof

\subsection{Esercizio 2}
\begin{thm}
	Dire se il seguente giudizio è derivabile
	\begin{scriptsize}
		\[(\forall x \in A)(\exists y \in B)R(x, y) \to (\forall x_1\in A)(\forall x_2\in A)(\exists y_1\in B)(\exists y_2\in B)(( R(x_1, y_1)\ \wedge\ R(x_2, y_2))\ \wedge\  (x_1 =_A x_2\ \to y_1 =_B y_2))\]
	\end{scriptsize}
\end{thm}
\proof
Dobbiamo trovare un proof-term del seguente tipo
\begin{scriptsize}
	\[ \Pi_{x\in A}\Sigma_{y\in B}R(x, y) \to \Pi_{x_1\in A}\Pi_{x_2\in A}\Sigma_{y_1\in B}\Sigma_{y_2\in B}(R(x_1, y_1)\times R(x_2, y_2)\times (\Id{A}{x_1}{x_2} \to \Id{B}{y_1}{y_2}))\]
\end{scriptsize}
Avendo un elemento di $\Pi_{x\in A}\Sigma_{y\in B}R(x,y)$, per via della validità dell'Assioma di Scelta possiamo ottenere un elemento $f \in A \to B$ tale per cui $R(x, f(x))$ risulta abitato per ogni $x \in A$. A questo punto, dati $x_1, x_2 \in A$ possiamo scegliere
\[ y_1 := f(x_1) \qquad y_2 := f(x_2) \]
in modo che $R(x_1, y_1)$ e $R(x_2, y_2)$ siano abitati, e inoltre, dato un proof-term
\[ w \in \Id{A}{x_1}{x_2}\]
otteniamo
\[ \mathrm{El}_{\mathrm{Id}}(w, (x').\mathrm{id}(f(x'))) \in \Id{B}{f(x_1)}{f(x_2)}\] ovvero un proof-term di 
\[ \Id{B}{y_1}{y_2} \]
come richiesto.
\endproof

\subsection{Esercizio 3}
\begin{thm}
	Supposto di rappresentare il tipo dei booleani come $Boole\equiv N_1~+~N_1$, con $0\equiv inl(*)$ e $1\equiv inr(*)$, e supposto che esista un proof-term $dis~\in~N_0~[z~\in~Id(Boole, 0, 1)]$, si dimostri che,dati due tipi \textit{A type} e \textit{B type} esiste una funzione
	\[f(z)~\in~\Sigma_{x\in {Boole}}~((Id(Boole,x,1)\rightarrow A)~\times~(Id(Boole,x,0)\rightarrow B))~[z~\in~A~+~B]\] \\
	ed anche una funzione
	\[g(w)~\in~A~+~B~[w~\in~\Sigma_{x\in {Boole}}~((Id(Boole,x,1)\rightarrow A)~\times~(Id(Boole,x,0)\rightarrow B))]\]
\end{thm}
\lstinputlisting[language=Coq]{res/code/traduzioneLogica/es3.v}

\subsection{Esercizio 4}
\begin{thm}
	Le funzioni $f(z)$ e $g(w)$ stabiliscono un isomorfismo nel senso della definizione 9.6 tra $A~+~B$ e $\Sigma_{x\in {Boole}}~((Id(Boole,x,1)\rightarrow A)~\times~(Id(Boole,x,0)\rightarrow B))$?
\end{thm}
Si, infatti è possibile definire due proof-terms \textbf{pf1} e \textbf{pf2} tali che $pf_1~\in~Id(A~+~B, x,g(f(x)))~[\Gamma,~x~\in~A~+~B]$ e $pf_2~\in~Id(\Sigma_{x\in {Boole}}~((Id(Boole,x,1)\rightarrow A)~\times~(Id(Boole,x,0)\rightarrow B)), y,f(g(y)))~[\Gamma,~y~\in~\Sigma_{x\in {Boole}}~((Id(Boole,x,1)\rightarrow A)~\times~(Id(Boole,x,0)\rightarrow B))]$
\lstinputlisting[language=Coq]{res/code/traduzioneLogica/es4.v}

\subsection{Esercizio 6}
\begin{thm}
	Si noti che in teoria dei tipi vale il seguente principio chiamato \textit{existence property under a context}: se $\exists y~\phi(y)~true~[\Gamma]$ allora esiste un proof-term \textbf{pf} tale che $\phi(pf)~true~[\Gamma]$.
\end{thm}
\lstinputlisting[language=Coq]{res/code/traduzioneLogica/es6.v}

\subsection{Esercizio 7}
\begin{thm}
	Per ogni connettivo e quantificatore della logica predicativa con uguaglianza si descrivano le relative regole di formazione, introduzione, eliminazione ed uguaglianza che risultano ammissibili in teoria dei tipi.
\end{thm}
Siano $\Phi$ e $\Psi$ due proposizioni.
\paragraph{And} \mbox{} \\
\AxiomC{$\Phi~prop~[\Gamma]$}
\AxiomC{$\Psi~prop~[\Gamma]$}
\RightLabel{$F-\wedge$}
\BinaryInfC{$\Phi~\wedge~\Psi~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$a~\in~\Phi$}
\AxiomC{$b~\in~\Psi$}
\RightLabel{$I-\wedge$}
\BinaryInfC{$<a, b>~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$p~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\RightLabel{$E_1-\wedge$}
\UnaryInfC{$fst(p)~\in~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$p~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\RightLabel{$E_2-\wedge$}
\UnaryInfC{$snd(p)~\in~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$a~=~a'~\in~\Phi~[\Gamma]$}
\AxiomC{$b~=~b'~\in~\Psi~[\Gamma]$}
\RightLabel{$U_1-\wedge$}
\BinaryInfC{$<a,b>~=~<a',b'>~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$p~=~q~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\RightLabel{$U_2-\wedge$}
\UnaryInfC{$fst(p)~=~fst(q)~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$p~=~q~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\RightLabel{$U_3-\wedge$}
\UnaryInfC{$snd(p)~=~snd(q)~\in~\Phi~\wedge~\Psi~[\Gamma]$}
\DisplayProof

\paragraph{Or} \mbox{} \\
\AxiomC{$\Phi~prop~[\Gamma]$}
\AxiomC{$\Psi~prop~[\Gamma]$}
\RightLabel{$F-\vee$}
\BinaryInfC{$\Phi~\vee~\Psi~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$a~\in~\Phi~[\Gamma]$}
\RightLabel{$I_1-\vee$}
\UnaryInfC{$inl(a)~\in~\Phi~\vee~\Psi~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$a~\in~\Psi~[\Gamma]$}
\RightLabel{$I_2-\vee$}
\UnaryInfC{$inr(a)~\in~\Phi~\vee~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$p~\in~\Phi~\vee~\Psi~[\Gamma]$}
\AxiomC{$X~prop~[\Gamma]$}
\AxiomC{$d(u)~\in~X~[\Gamma,~u~\in~\Phi]$}
\AxiomC{$c(w)~\in~X~[\Gamma,~w~\in~\Psi]$}
\RightLabel{$E-\vee$}
\QuaternaryInfC{$case(p,~(u).d,~(w).c)~\in~X~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$a~=~a'~\in~\Phi~[\Gamma]$}
\RightLabel{$U_1-\vee$}
\UnaryInfC{$inl(a)~=~inl(a')~\in~\Phi~\vee~\Psi~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$b~=~b'~\in~\Psi~[\Gamma]$}
\RightLabel{$U_2-\vee$}
\UnaryInfC{$inr(b)~=~inr(b')~\in~\Phi~\vee~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$X~prop~[\Gamma]$}
\AxiomC{$p~=~q~\in~\Phi~\vee~\Psi~[\Gamma]$}
\AxiomC{$c(w)~=~d(u)~\in~X~[\Gamma,~w~\in~\Psi,~u~\in~\Phi]$}
\RightLabel{$U_3-\vee$}
\TrinaryInfC{$case(p,~(u).d,~(w).c)~=~case(q,~(u).d,~(w).c)~\in~\Phi~\vee~\Psi~[\Gamma]$}
\DisplayProof

\paragraph{Implica} \mbox{} \\
\AxiomC{$\Phi~prop~[\Gamma]$}
\AxiomC{$\Psi~prop~[\Gamma]$}
\RightLabel{$F-\to$}
\BinaryInfC{$\Phi~\to~\Psi~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$b(u)~\in~\Psi~[\Gamma,~u~\in~\Phi]$}
\RightLabel{$I-\to$}
\UnaryInfC{$\lambda u.b(u)~\in~\Phi~\to~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$f~\in~\Phi~\to~\Psi~[\Gamma]$}
\AxiomC{$p~\in~\Phi~[\Gamma]$}
\RightLabel{$E-\to$}
\BinaryInfC{$Ap(f, p)~\in~\Psi~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$b(u)~=~b'(u)~\in~\Psi~[\Gamma,~u~\in~\Phi]$}
\RightLabel{$U_1-\to$}
\UnaryInfC{$\lambda u.b(u)~=~\lambda u.b'(u)~\in~\Phi~\to~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$f~=~f'~\in~\Phi~\to~\Psi~[\Gamma]$}
\AxiomC{$p~=~p'~\in~\Phi~[\Gamma]$}
\RightLabel{$U_2-\to$}
\BinaryInfC{$Ap(f, p)~=~Ap(f',p')~\in~\Psi~[\Gamma]$}
\DisplayProof

\paragraph{Per ogni} \mbox{} \\
\AxiomC{$\Phi(x)~prop~[\Gamma,~x~\in~A]$}
\RightLabel{$F-\forall$}
\UnaryInfC{$(\forall x~\in~A)\Phi(x)~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$b(w)~\in~\Phi(w)~[\Gamma,~w~\in~A]$}
\RightLabel{$I-\forall$}
\BinaryInfC{$\lambda w.b(w)~\in~(\forall x~\in~A)\Phi(x)~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$f~\in~(\forall x~\in~A)\Phi(x)~[\Gamma]$}
\AxiomC{$t~\in~A~[\Gamma]$}
\RightLabel{$E-\forall$}
\TrinaryInfC{$Ap(f, t)~\in~\Phi(t)~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$b(w)~=b'(w)~\in~\Phi(w)~[\Gamma,~w~\in~A]$}
\RightLabel{$U_1-\forall$}
\BinaryInfC{$\lambda w.b(w)~=~\lambda w.b'(w)~\in~(\forall x~\in~A)\Phi(x)~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$f~=~f'~\in~(\forall x~\in~A)\Phi(x)~[\Gamma]$}
\AxiomC{$t~=~t'~\in~A~[\Gamma]$}
\RightLabel{$U_2-\forall$}
\TrinaryInfC{$Ap(f, t)~=~Ap(f',t')~\in~\Phi(t)~[\Gamma]$}
\DisplayProof

\paragraph{Esiste} \mbox{} \\
\AxiomC{$\Phi(x)~prop~[\Gamma,~x~\in~A]$}
\RightLabel{$F-\exists$}
\UnaryInfC{$(\exists x~\in~A)\Phi(x)~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$t~\in~A~[\Gamma]$}
\AxiomC{$p~\in~\Phi(t)~[\Gamma]$}
\RightLabel{$I-\exists$}
\TrinaryInfC{$<t, p>~\in~(\exists x~\in~A)\Phi(x)~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$\Psi~prop~[\Gamma]$}
\AxiomC{$p~\in~(\exists x~\in~A)\Phi(x)~[\Gamma]$}
\AxiomC{$q(w,~y)~\in~\Psi~[\Gamma,~w~\in~A,~y~\in~\Phi(x)]$}
\RightLabel{$E-\forall$}
\QuaternaryInfC{$unpack(p, (w,~y)q)~\in~\Psi~[\Gamma]$}
\DisplayProof

\vspace{0.2in}
\AxiomC{$A~type~[\Gamma]$}
\AxiomC{$t~=~t'~\in~A~[\Gamma]$}
\AxiomC{$p~=~p'~\in~\Phi(t)~[\Gamma]$}
\RightLabel{$U_1-\exists$}
\TrinaryInfC{$<t, p>~=~<t',p'>~\in~(\exists x~\in~A)\Phi(x)~[\Gamma]$}
\DisplayProof

\begin{scriptsize}
	\vspace{0.2in}
	\AxiomC{$A~type~[\Gamma]$}
	\AxiomC{$\Psi~prop~[\Gamma]$}
	\AxiomC{$p~=~p'~\in~(\exists x~\in~A)\Phi(x)~[\Gamma]$}
	\AxiomC{$q(w,~y)~=~q'(w,~y)~\in~\Psi~[\Gamma,~w~\in~A,~y~\in~\Phi(x)]$}
	\RightLabel{$E-\forall$}
	\QuaternaryInfC{$unpack(p, (w,~y)q)~=~unpack(p', (w,~y)q')~\in~\Psi~[\Gamma]$}
	\DisplayProof
\end{scriptsize}


\paragraph{Uguaglianza} \mbox{} \\
\AxiomC{$\Phi~prop~[\Gamma]$}
\RightLabel{$F-=$}
\UnaryInfC{$\Phi~=\Phi~prop~[\Gamma]$}
\DisplayProof\qquad
\AxiomC{$a~\in~Phi$}
\RightLabel{$I-=$}
\UnaryInfC{$id(a)~\in~\Phi~=~\Phi~[\Gamma]$}
\DisplayProof
	
\begin{scriptsize}
	\vspace{0.2in}
	\AxiomC{$C(x,~y)~type~[\Gamma,~x~\in~\Phi,~y~\in~Phi]$}
	\AxiomC{$a~\in~\Phi~[\Gamma]$}
	\AxiomC{$b~\in~\Phi~[\Gamma]$}
	\AxiomC{$p~\in~\Phi~=~\Phi~[\Gamma]$}
	\AxiomC{$c(x)~\in~C(x,~id(x))~[\Gamma,~x\in~\Phi]$}
	\RightLabel{$E-=$}
	\QuinaryInfC{$sse(p,~c)~\in~C(b,~p)~[\Gamma]$}
	\DisplayProof
\end{scriptsize}

\vspace{0.2in}
\AxiomC{$a~=~b~\in~\Phi~[\Gamma]$}
\RightLabel{$U_1-=$}
\UnaryInfC{$id(a)~=~id(b)~\in~\Phi~=~\Phi~[\Gamma]$}
\DisplayProof

\begin{scriptsize}
	\vspace{0.2in}
	\AxiomC{$C(x,~y)~type~[\Gamma,~x~\in~\Phi,~y~\in~Phi]$}
	\AxiomC{$a~=~b~\in~\Phi~[\Gamma]$}
	\AxiomC{$p~=~q~\in~\Phi~=~\Phi~[\Gamma]$}
	\AxiomC{$c(x)~=~d(x)~\in~C(x,~id(x))~[\Gamma,~x\in~\Phi]$}
	\RightLabel{$U_2-=$}
	\QuaternaryInfC{$sse(p,~c)=~sse(q,~d)~\in~C(b,~p)~[\Gamma]$}
	\DisplayProof
\end{scriptsize}